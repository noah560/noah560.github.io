<!DOCTYPE html>
<html>
  <head>
    <script src="/p5.js"></script>
  </head>
  <body>
    <main>
      <h1>Car Game</h1>
    </main>
    <script>
let score = 0;
let carX = 0;
let lane = 0;
const laneSize = 100;
let wallTimer = 100;

class Wall {
  constructor(x, Wlane){
    this.lane = Wlane;
    this.x = x;
  }
  draw(){
    strokeWeight(0);
    fill(0, 0, 255);
    rect(this.x-carX, this.lane * (height/2), 20, height/2);
  }
}

let walls = [];

function setup(){
  createCanvas(400, 200);
}

function drawCar(x, y){
  let carHeight = 60;
  strokeWeight(0);
  fill(255, 0, 0);
  rect(x, y + 10, 80, carHeight);
  fill(0);
  rect(x, y, 30, 10);
  rect(x + 50, y, 30, 10);
  rect(x, y + carHeight + 10, 30, 10);
  rect(x + 50, y + carHeight + 10, 30, 10);
}

function drawRoad(){
  strokeWeight(0);
  fill(255);
  for (let x = -carX; x < width; x += 60){
    rect(x, height/2 - 5, 30, 10);
  }
}

function newWall(){
  let Wlane = 0;
  if (Math.random() < 0.5){
    Wlane = 1;
  }
  walls.push(new Wall(carX + width, Wlane));
  console.log("New wall:");
  console.log("  x: " + carX + width);
  console.log("  lane: " + Wlane)
}

function keyPressed(){
  lane = 1 - lane;
}

function draw(){
  background(128);
  drawRoad();
  drawCar(0, lane * (height/2));
  for (let i = 0; i < walls.length; i++){
    walls[i].draw();
    if (walls[i].x < carX+80){
      if (walls[i].lane == lane){
        if (walls[i].x > carX){
          walls = [];
          carX = 0;
          wallTimer = 100;
          score = 0;
        }
      }
    }
  }
  carX += 2;
  wallTimer--;
  score++;
  if (wallTimer < 1){
    newWall();
    wallTimer = 70 + (Math.random() * 80);
  }
  fill(255, 255, 255);
  strokeWeight(5);
  text(score.toString(), 90, 50);
}
    </script>
  </body>
</html>
